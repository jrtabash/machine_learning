In [5]: %run machine_learning/metro_traffic/metro_traffic.py

In [6]: xl, xt, yl, yt = getDataForNeuralNetworkModel(standardScaler=True)

In [7]: model = makeNeuralNetworkModel(xl, yl, epochs=20)
Epoch 1/20
30431/30431 [==============================] - 1s 24us/sample - loss: 1.2269 - acc: 0.4773
Epoch 2/20
30431/30431 [==============================] - 1s 23us/sample - loss: 0.9025 - acc: 0.5933
Epoch 3/20
30431/30431 [==============================] - 1s 23us/sample - loss: 0.7965 - acc: 0.6629
Epoch 4/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.7449 - acc: 0.6983
Epoch 5/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.7096 - acc: 0.7187
Epoch 6/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.6825 - acc: 0.7357
Epoch 7/20
30431/30431 [==============================] - 1s 23us/sample - loss: 0.6632 - acc: 0.7503
Epoch 8/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.6482 - acc: 0.7599
Epoch 9/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.6359 - acc: 0.7683
Epoch 10/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.6262 - acc: 0.7735
Epoch 11/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.6177 - acc: 0.7817
Epoch 12/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.6101 - acc: 0.7863
Epoch 13/20
30431/30431 [==============================] - 1s 23us/sample - loss: 0.6033 - acc: 0.7945
Epoch 14/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.5976 - acc: 0.7984
Epoch 15/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.5924 - acc: 0.8011
Epoch 16/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.5871 - acc: 0.8044
Epoch 17/20
30431/30431 [==============================] - 1s 23us/sample - loss: 0.5828 - acc: 0.8108
Epoch 18/20
30431/30431 [==============================] - 1s 23us/sample - loss: 0.5785 - acc: 0.8127
Epoch 19/20
30431/30431 [==============================] - 1s 24us/sample - loss: 0.5747 - acc: 0.8159
Epoch 20/20
30431/30431 [==============================] - 1s 23us/sample - loss: 0.5705 - acc: 0.8192

In [8]: model.evaluate(xt.values, yt.values.ravel())
10144/10144 [==============================] - 0s 34us/sample - loss: 0.5641 - acc: 0.8198
Out[8]: [0.5641434522645331, 0.81979495]

In [9]: 

In [125]: nnPredict(model, xt.values[:1])
Out[125]: [3]

In [126]: nnPredictLabels(model, xt.values[:1])
Out[126]: ['High']

In [127]: nnPredictionLabel(yt.values.ravel()[0])
Out[127]: 'High'

In [128]: 
